<svg xmlns="http://www.w3.org/2000/svg" width="960" height="480" viewBox="0 0 960 480" role="img" aria-labelledby="title desc">
  <title id="title">TB-Scale Search Product - System Architecture</title>
  <desc id="desc">User queries enter a query classifier that routes to DuckDB, Trino, or Google Cloud Dataproc engines. A geofencing layer enforces data residency, and Kubernetes handles dynamic pod scaling.</desc>

  <defs>
    <style>
      .bg { fill: #f8fafc; }
      .border { stroke: #cbd5e1; stroke-width: 1.5; fill: none; }
      .box { fill: #ffffff; stroke: #94a3b8; stroke-width: 1.5; rx: 10; ry: 10; }
      .box-primary { fill: #eff6ff; stroke: #3b82f6; stroke-width: 2; rx: 10; ry: 10; }
      .box-engine { fill: #fefce8; stroke: #ca8a04; stroke-width: 2; rx: 10; ry: 10; }
      .box-infra { fill: #f0fdf4; stroke: #22c55e; stroke-width: 1.5; rx: 10; ry: 10; }
      .box-gate { fill: #fef2f2; stroke: #ef4444; stroke-width: 1.5; rx: 10; ry: 10; }
      .label { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 14px; font-weight: 600; fill: #0f172a; text-anchor: middle; }
      .sub { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 11px; fill: #475569; text-anchor: middle; }
      .title-text { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; font-size: 11px; fill: #64748b; text-anchor: middle; font-weight: 500; letter-spacing: 0.5px; }
      .connector { stroke: #475569; stroke-width: 1.5; fill: none; marker-end: url(#arrow); }
    </style>
    <marker id="arrow" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto-start-reverse">
      <path d="M 0 0 L 8 4 L 0 8 z" fill="#475569" />
    </marker>
  </defs>

  <rect class="bg" x="1" y="1" width="958" height="478" rx="14" ry="14" />
  <rect class="border" x="1" y="1" width="958" height="478" rx="14" ry="14" />

  <!-- User Query -->
  <rect class="box" x="380" y="20" width="200" height="50" />
  <text class="label" x="480" y="42">User Search Query</text>
  <text class="sub" x="480" y="58">text + filters + location</text>

  <!-- Arrow to Geofencing -->
  <path class="connector" d="M480 70 L480 105" />

  <!-- Geofencing Gate -->
  <rect class="box-gate" x="330" y="105" width="300" height="50" />
  <text class="label" x="480" y="128" style="fill:#b91c1c">Geofencing / Data Residency Gate</text>
  <text class="sub" x="480" y="144">region-aware access control</text>

  <!-- Arrow to Router -->
  <path class="connector" d="M480 155 L480 190" />

  <!-- Query Router / Classifier -->
  <rect class="box-primary" x="330" y="190" width="300" height="55" />
  <text class="label" x="480" y="214" style="fill:#1e40af">Query Router / Classifier</text>
  <text class="sub" x="480" y="232">profiles query class, selects engine</text>

  <!-- Fan-out to 3 engines -->
  <path class="connector" d="M480 245 L480 270" />
  <path class="connector" d="M480 270 L180 270 L180 300" />
  <path class="connector" d="M480 270 L480 300" />
  <path class="connector" d="M480 270 L780 270 L780 300" />

  <!-- Engine 1: DuckDB -->
  <rect class="box-engine" x="80" y="300" width="200" height="65" />
  <text class="label" x="180" y="327" style="fill:#854d0e">DuckDB</text>
  <text class="sub" x="180" y="345">local analytical path</text>
  <text class="sub" x="180" y="358">fast single-node queries</text>

  <!-- Engine 2: Trino -->
  <rect class="box-engine" x="380" y="300" width="200" height="65" />
  <text class="label" x="480" y="327" style="fill:#854d0e">Trino</text>
  <text class="sub" x="480" y="345">federated distributed</text>
  <text class="sub" x="480" y="358">cross-source queries</text>

  <!-- Engine 3: Dataproc -->
  <rect class="box-engine" x="680" y="300" width="200" height="65" />
  <text class="label" x="780" y="327" style="fill:#854d0e">Google Cloud Dataproc</text>
  <text class="sub" x="780" y="345">heavy batch workloads</text>
  <text class="sub" x="780" y="358">large-scale scans</text>

  <!-- Kubernetes layer -->
  <text class="title-text" x="480" y="395">INFRASTRUCTURE</text>
  <line x1="100" y1="400" x2="860" y2="400" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="4,3" />

  <rect class="box-infra" x="200" y="410" width="260" height="45" />
  <text class="label" x="330" y="430" style="fill:#166534">Kubernetes (EKS)</text>
  <text class="sub" x="330" y="446">dynamic pod scaling</text>

  <rect class="box" x="500" y="410" width="260" height="45" />
  <text class="label" x="630" y="430">TB-Scale Data Store</text>
  <text class="sub" x="630" y="446">proprietary datasets</text>
</svg>
